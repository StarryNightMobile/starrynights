<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Starry Night Mobiles - Checkout Enabled</title>
<link rel="stylesheet" href="cleaned-premium-style.css">
<style>
/* ===================== CHECKOUT PANEL ===================== */
#checkoutPanel {
  position:fixed;
  top:0; right:0;
  width:400px;
  max-width:90%;
  height:100%;
  background:rgba(10,15,30,.95);
  color:white;
  padding:30px;
  transform:translateX(100%);
  transition:transform 0.4s ease;
  z-index:9999;
  overflow-y:auto;
}
#checkoutPanel.active {
  transform:translateX(0);
}
#checkoutPanel h3{
  margin-bottom:20px;
  text-align:center;
}
#checkoutPanel .closeBtn{
  position:absolute;
  top:15px; right:15px;
  background:var(--accent);
  border:none; color:white;
  width:30px;height:30px;
  border-radius:50%;
  cursor:pointer;
  font-weight:bold;
}
#checkoutPanel label{
  display:block; margin:10px 0 5px;
}
#checkoutPanel input, #checkoutPanel select{
  width:100%;
  padding:8px;
  margin-bottom:10px;
  border-radius:6px;
  border:1px solid var(--accent);
  background:rgba(255,255,255,.05);
  color:white;
}
#paymentSection{ display:none; margin-top:20px; }
#paymentSection button{ width:100%; margin-top:10px; }
#successMessage{
  display:none; text-align:center; margin-top:20px; color:#0f0;
  font-weight:bold; font-size:18px;
}
</style>
</head>
<body>

<div id="loader"><div class="loader-logo">Starry Night</div></div>
<canvas id="particles"></canvas>
<div class="cursor"></div>
<div class="light-reflection"></div>

<header>
  <h3>Starry Night</h3>
  <div>
    <button class="btn btn-ghost" onclick="scrollToShop()">Shop</button>
    <button class="btn btn-primary" onclick="openCart()">Cart</button>
  </div>
</header>

<!-- HERO -->
<section id="hero" class="section">
  <div class="smoke"></div>
  <div class="hero-text">
    <h1>Experience the Future</h1>
    <p>Premium smartphones engineered for performance.</p>
  </div>
  <div id="phone-container">
    <div id="phone"><img src="logo.png"></div>
  </div>
</section>

<!-- SHOP -->
<section id="shop" class="section">
  <div>
    <h2 style="margin-bottom:60px">Shop Collection</h2>
    <div class="products">
      <div class="card">
        <img src="logo.png">
        <h4>iPhone 15 Pro</h4>
        <p>$1550</p>
        <button class="btn btn-primary" onclick="startCheckout('iPhone 15 Pro',1550)">Buy Now</button>
      </div>
    </div>
  </div>
</section>

<!-- CHECKOUT PANEL -->
<div id="checkoutPanel">
  <button class="closeBtn" onclick="closeCheckout()">Ã—</button>
  <h3>Checkout</h3>
  <div id="orderSummary"></div>
  <div id="paymentSection">
    <label for="name">Full Name</label>
    <input type="text" id="name" placeholder="Your Name" required>
    <label for="email">Email</label>
    <input type="email" id="email" placeholder="you@example.com" required>
    <label for="phone">Phone</label>
    <input type="text" id="phone" placeholder="0771234567" required>
    <label for="paymentMethod">Payment Method</label>
    <select id="paymentMethod">
      <option value="paynow">Pay Now (70% Deposit)</option>
      <option value="cash">Cash on Delivery</option>
    </select>
    <button class="btn btn-primary" onclick="processPayment()">Confirm Order</button>
  </div>
  <div id="successMessage">Thank you! Your order has been received.</div>
</div>

<script>
/* ===================== CHECKOUT LOGIC ===================== */
let currentProduct = '';
let currentPrice = 0;

function startCheckout(product, price){
  currentProduct = product;
  currentPrice = price;
  document.getElementById('checkoutPanel').classList.add('active');
  document.getElementById('orderSummary').innerHTML =
    `<p><strong>Product:</strong> ${product}</p>
     <p><strong>Total:</strong> $${price}</p>
     <p><strong>Deposit (70%):</strong> $${(price*0.7).toFixed(2)}</p>`;
  document.getElementById('paymentSection').style.display='block';
}

function closeCheckout(){
  document.getElementById('checkoutPanel').classList.remove('active');
  document.getElementById('paymentSection').style.display='none';
  document.getElementById('successMessage').style.display='none';
}

/* PROCESS PAYMENT (NETLIFY FUNCTION) */
function processPayment(){
  const method=document.getElementById('paymentMethod').value;
  const name=document.getElementById('name').value;
  const email=document.getElementById('email').value;
  const phone=document.getElementById('phone').value;

  if(!name || !email || !phone){ alert('Please fill all fields'); return;}

  if(method==='paynow'){
    fetch('/.netlify/functions/paynow',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        product: currentProduct,
        amount: (currentPrice*0.7).toFixed(2),
        name, email, phone
      })
    })
    .then(res=>res.json())
    .then(data=>{
      console.log('Payment response:',data);
      showSuccess();
    })
    .catch(err=>{
      console.error(err);
      alert('Payment failed, try again');
    });
  } else if(method==='cash'){
    console.log('Cash order:',{name,email,phone,product:currentProduct});
    showSuccess();
  }
}

function showSuccess(){
  document.getElementById('paymentSection').style.display='none';
  document.getElementById('successMessage').style.display='block';
  setTimeout(()=>{ window.location.href='thankyou.html'; },2000);
}

/* ===================== OTHER PREMIUM UI ===================== */
/* Loader */
window.addEventListener("load",()=>{
  const loader=document.getElementById("loader");
  loader.style.opacity="0";
  setTimeout(()=>loader.remove(),800);
});

/* Header shrink */
window.addEventListener("scroll",()=>{
  document.querySelector("header").classList.toggle("shrink",window.scrollY>50);
});

/* Cursor */
const cursor=document.querySelector(".cursor");
document.addEventListener("mousemove",e=>{
  cursor.style.left=e.clientX+"px";
  cursor.style.top=e.clientY+"px";
});

/* Particles */
const canvas=document.getElementById("particles");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let particles=[];
document.addEventListener("mousemove",e=>{
  particles.push({x:e.clientX,y:e.clientY,size:Math.random()*4+1,alpha:1});
});
function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach((p,i)=>{
    p.alpha-=0.02;
    p.size*=0.97;
    if(p.alpha<=0)particles.splice(i,1);
    ctx.fillStyle=`rgba(31,110,212,${p.alpha})`;
    ctx.beginPath();ctx.arc(p.x,p.y,p.size,0,Math.PI*2);ctx.fill();
  });
  requestAnimationFrame(animateParticles);
}
animateParticles();

/* Shop scroll */
function scrollToShop(){
  document.getElementById("shop").scrollIntoView({behavior:"smooth"});
}

/* 3D phone rotation */
const phone=document.getElementById("phone");
document.getElementById("phone-container").addEventListener("mousemove",e=>{
  const rect=e.currentTarget.getBoundingClientRect();
  const x=e.clientX-rect.left; const y=e.clientY-rect.top;
  const rotateY=(x/rect.width-0.5)*20; const rotateX=(y/rect.height-0.5)*-20;
  phone.style.transform=`rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
});
document.getElementById("phone-container").addEventListener("mouseleave",()=>{phone.style.transform='rotateX(0deg) rotateY(0deg)';});
</script> 
  }
</body>
</html>/